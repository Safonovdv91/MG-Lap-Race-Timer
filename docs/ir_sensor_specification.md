# Спецификация на ИК датчики с модуляцией

## Общее описание
Для замены текущей системы управления через замыкания 3.3В на контактах GPIO14 и GPIO27 планируется внедрение ИК передатчиков и приемников с модуляцией сигнала. Это позволит создать более надежную и точную систему детектирования пересечения луча.

## Компоненты

### Приемник
- Модель: TSOP38238
- Частота модуляции: 38 кГц
- Напряжение питания: 2.7-5.5 В
- Тип выходного сигнала: активный низкий уровень
- Угол обзора: ±45°
- Расстояние действия: до нескольких метров (в зависимости от передатчика)

### Передатчик
- Компоненты: ИК светодиод (например, TSAL6200) и генератор 38 кГц
- Частота модуляции: 38 кГц (стандартная частота для ИК пультов)
- Дальность передачи: до нескольких метров
- Управление: ШИМ с частотой 38 кГц

## Схема подключения

### ИК Приемник (TSOP38238) -> ESP32
- VCC (пин 3) -> 3.3V
- GND (пин 2) -> GND
- OUT (пин 1) -> GPIO14 (SENSOR1_PIN) или GPIO27 (SENSOR2_PIN)

### ИК Передатчик (ИК светодиод + генератор 38 кГц) <- ESP32
- Включение передатчика -> GPIO (например, GPIO13 для управления питанием передатчика)
- Модуляция 38 кГц -> отдельный ШИМ генератор или программная генерация

## Принцип работы
1. ИК передатчик постоянно излучает модулированный сигнал частотой 38 кГц
2. Приемник (TSOP38238) ожидает этот сигнал и держит выход в высоком состоянии
3. При пересечении луча между передатчиком и приемником, сигнал блокируется
4. Приемник переходит в низкое состояние (активный низкий уровень)
5. ESP32 детектирует фронт спадающего импульса как событие пересечения луча
6. После восстановления луча, система готова к следующему срабатыванию

## Преимущества перед текущей системой
- Беспроводная передача сигнала между датчиками
- Возможность установки датчиков на большем расстоянии друг от друга
- Устойчивость к электромагнитным помехам благодаря модуляции
- Более точное определение момента пересечения луча
- Возможность настройки чувствительности

## Технические особенности
- Использование прерываний для детектирования пересечения луча
- Возможность программной генерации 38 кГц ШИМ сигнала
- Обработка ложных срабатываний и защита от помех
- Возможность регулировки чувствительности через программные параметры