# План изменений в коде для поддержки ИК сенсоров с модуляцией

## Цель
Заменить текущую систему детектирования срабатывания через замыкания 3.3В на ИК сенсоры с модуляцией сигнала.

## Изменения в конфигурации

### config.h
- Оставить определения SENSOR1_PIN и SENSOR2_PIN для подключения ИК приемников
- Добавить определения для ИК передатчиков (например, TX_SENSOR1_PIN и TX_SENSOR2_PIN)
- Добавить настройки для генерации ШИМ сигнала 38 кГц

### main.cpp
- В setup() инициализировать пины для ИК передатчиков как выходы
- Включить ИК передатчики в начале работы
- Проверить корректность обработки прерываний для новых ИК приемников

## Изменения в системе обработки сигналов

### measurements.cpp
- Изменить логику обработчиков прерываний handleSensor1() и handleSensor2()
- Текущая реализация реагирует на спадающий фронт (FALLING) при замыкании на землю
- Для ИК системы нужно будет реагировать на спадающий фронт при пересечении луча (блокировке сигнала)
- Добавить проверки для фильтрации ложных срабатываний
- Настроить параметры debounce_time для ИК системы

## Программная генерация ШИМ 38 кГц

### Новый модуль ir_transmitter.cpp/h
- Создать класс для управления ИК передатчиками
- Реализовать генерацию ШИМ сигнала 38 кГц
- Обеспечить возможность включения/выключения передатчиков
- Добавить настройки мощности излучения (через скважность ШИМ)

## Обновление веб-интерфейса

### web_handlers.cpp
- Добавить информацию о статусе ИК передатчиков
- Возможность включения/выключения передатчиков через веб-интерфейс
- Отображение состояния луча (активен/заблокирован)

## Изменения в настройках

### config.cpp
- Добавить функции сохранения/загрузки настроек ИК системы
- Параметры чувствительности и настройки передатчиков

## Тестирование и отладка

### Новые функции диагностики
- Возможность проверки работоспособности ИК передатчиков и приемников
- Временные метки срабатывания для точной настройки
- Логирование событий пересечения луча